---
title: CVE-2022-25844
---

## Vulnerability Details
CVE-2022-25844 is a Regular Expression Denial of Service (ReDoS) vulnerability in AngularJS affecting the `currency` filter through the `$locale.NUMBER_FORMATS.PATTERNS[1].posPre` value.

## The Vulnerability

### Problem
The AngularJS `currency` filter is vulnerable to **catastrophic regular-expression backtracking** when an attacker controls the `$locale.NUMBER_FORMATS.PATTERNS[1].posPre` value. This can result in a denial of service attack through excessive CPU consumption.

### Impact
Attackers could:
1. **Freeze the browser tab** temporarily through excessive CPU usage
2. **Cause denial of service** by making the application unresponsive
3. **Degrade application performance** for affected users
4. **Consume excessive system resources** on the client side

### Technical Details
The vulnerability occurs when an attacker controls the locale `posPre` field and sets it to a value that causes catastrophic regular-expression backtracking during currency formatting. The malicious pattern triggers super-linear runtime behavior.

This is essentially equivalent to:
```javascript
$locale.NUMBER_FORMATS.PATTERNS[1].posPre = maliciousPattern;
// Currency filter processing becomes extremely slow
```

## Patch Information

### Commit Details
- **Commit SHA**: [a2819f1d8](https://github.com/TJSTONE99/angular.js-lts/commit/a2819f1d82fc2821ee11a04fea473e623f59e8d9)
- **Author**: TJSTONE99
- **Date**: January 2, 2026
- **Message**: fix: CVE-2022-25844

### Fix Summary
The patch fixes ReDoS vulnerability in the `currency` filter by implementing input validation and safer regex handling:

1. **Input validation**: Added validation to prevent malicious locale patterns from causing ReDoS
2. **Safer regex handling**: Implemented protective measures around regex operations in currency formatting
3. **Performance limits**: Added safeguards to prevent excessive CPU consumption
4. **Comprehensive testing**: Added extensive test coverage for ReDoS scenarios

### Files Modified
- `src/ng/filter/filters.js`
- `test/ng/filter/filtersSpec.js`

### Key Changes
The fix adds validation and protective measures to the `currency` filter to prevent malicious locale patterns from triggering catastrophic backtracking. The implementation includes input sanitization, performance monitoring, and comprehensive test coverage to ensure the vulnerability cannot be exploited while maintaining full currency formatting functionality.

## References
- NVD: https://nvd.nist.gov/vuln/detail/CVE-2022-25844
- HeroDevs Vulnerability Directory: https://www.herodevs.com/vulnerability-directory/cve-2022-25844?nes-for-angularjs=
- Debian Security Tracker: https://security-tracker.debian.org/tracker/CVE-2022-25844

### Pre-patch PoC
The `currency` filter is vulnerable to catastrophic regular-expression backtracking when an attacker controls the `$locale.NUMBER_FORMATS.PATTERNS[1].posPre` value, causing the browser tab to freeze temporarily through excessive CPU usage.

:::warning
**⚠️ WARNING:** Clicking the "ReDoS now" button below will freeze the browser tab temporarily.
:::

The demonstration below reproduces CVE-2022-25844 by mutating the AngularJS `$locale` service and forcing repeated execution of the `currency` filter with a malicious `posPre` pattern.

<iframe 
  src="/angular-lts-docs/cve-demos/CVE-2022-25844/unpatched/index.html" 
  width="100%" 
  height="500" 
  style={{border: '1px solid #e1e4e8', borderRadius: '6px'}}
  title="CVE-2022-25844 Vulnerable Demo">
</iframe>

### Post-patch PoC
Malicious locale patterns no longer cause performance issues, currency formatting remains fast regardless of input size, and normal currency display functionality continues to work.

<iframe 
  src="/angular-lts-docs/cve-demos/CVE-2022-25844/patched/index.html" 
  width="100%" 
  height="500" 
  style={{border: '1px solid #e1e4e8', borderRadius: '6px'}}
  title="CVE-2022-25844 Patched Demo">
</iframe>

## References
- NVD: https://nvd.nist.gov/vuln/detail/CVE-2022-25844
- HeroDevs Vulnerability Directory: https://www.herodevs.com/vulnerability-directory/cve-2022-25844?nes-for-angularjs=
- Debian Security Tracker: https://security-tracker.debian.org/tracker/CVE-2022-25844
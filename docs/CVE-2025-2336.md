---
title: CVE-2025-2336
---

## Vulnerability Details
CVE-2025-2336 is an image source sanitization bypass vulnerability in AngularJS affecting the `$sanitize` service and SVG `<image>` element detection.

## The Vulnerability

### Problem
The `$sanitize` service is used for sanitizing HTML strings by stripping potentially dangerous tokens. As part of sanitization, it checks image URLs to ensure they comply with defined image source rules. However, **SVG `<image>` elements are not correctly detected as images** by the `$sanitize` service, allowing them to bypass image source restrictions.

### Impact
Attackers could:
1. **Bypass image source sanitization rules** configured by the application
2. **Load SVG images from unauthorized domains** or schemes via `ng-bind-html`
3. **Perform content spoofing attacks** by displaying malicious SVG images in sanitized HTML
4. **Degrade application performance** with large or slow-to-load SVG images

### Technical Details
The vulnerability affects:
- `$sanitize` service directly
- `ng-bind-html` directive (which uses `$sanitize` internally)
- `linky` filter (which uses `$sanitize` internally)

SVG `<image>` elements with `href` or `xlink:href` attributes are not subject to the same image source validation as regular `<img>` elements, allowing unauthorized images to be displayed in sanitized HTML content.

## Testing the Fix

### Pre-patch PoC
SVG `<image>` elements bypass image source sanitization in `$sanitize` service, allowing `ng-bind-html` to display unauthorized SVG images and `linky` filter to allow unauthorized SVG images in processed content.

The demonstration below shows how SVG `<image>` elements bypass sanitization while regular `<img>` elements are properly sanitized, using an interactive interface to test different image URLs and HTML payloads.

<iframe 
  src="/angular-lts-docs/cve-demos/CVE-2025-2336/unpatched/index.html" 
  width="100%" 
  height="700" 
  style={{border: '1px solid #e1e4e8', borderRadius: '6px'}}
  title="CVE-2025-2336 Vulnerable Demo">
</iframe>

### Post-patch PoC
SVG `<image>` elements are properly detected and sanitized by `$sanitize` service. Unauthorized SVG image sources are stripped from sanitized HTML, and `ng-bind-html` and `linky` filter properly enforce image source restrictions.

<iframe 
  src="/angular-lts-docs/cve-demos/CVE-2025-2336/patched/index.html" 
  width="100%" 
  height="700" 
  style={{border: '1px solid #e1e4e8', borderRadius: '6px'}}
  title="CVE-2025-2336 Patched Demo">
</iframe>

### Expected Behavior After Fix
- `$sanitize` service applies `imgSrcSanitizationTrustedUrlList` rules to SVG `<image>` elements
- `ng-bind-html` properly sanitizes SVG images according to configured rules
- `linky` filter respects image source restrictions for SVG content
- Regular `<img>` elements continue to work correctly (not affected by this vulnerability)

## Patch Information

### Commit Details
- **Commit SHA**: [26809d90d](https://github.com/TJSTONE99/angular.js-lts/commit/26809d90d34744d49f601a48b4d26780d34cbe85)
- **Author**: TJSTONE99
- **Date**: January 2, 2026
- **Message**: fix: CVE-2025-2336

### Fix Summary
The patch fixes SVG `<image>` element sanitization by extending the image detection logic in the `$sanitize` service:

1. **Extended image detection**: Modified the `isImage` check to include SVG `<image>` elements with `href` or `xlink:href` attributes
2. **Consistent sanitization**: Ensures SVG images are subject to the same URL validation as regular `<img>` elements
3. **Maintained compatibility**: Preserves existing behavior for all other elements and attributes

### Files Modified
- `src/ngSanitize/sanitize.js`

### Key Changes
```javascript
// Before (vulnerable)
var isImage = (tag === 'img' && lkey === 'src') || (lkey === 'background');

// After (fixed)
var isImage = (tag === 'img' && lkey === 'src') || (lkey === 'background') || 
              (tag === 'image' && (lkey === 'href' || lkey ==='xlink:href'));
```

The fix ensures that SVG `<image>` elements with `href` or `xlink:href` attributes are properly recognized as image sources and subjected to the same sanitization rules as regular `<img>` elements.

## References
- NVD: https://nvd.nist.gov/vuln/detail/CVE-2025-2336
- HeroDevs Vulnerability Directory: https://www.herodevs.com/vulnerability-directory/cve-2025-2336?nes-for-angularjs=
- Debian Security Tracker: https://security-tracker.debian.org/tracker/CVE-2025-2336
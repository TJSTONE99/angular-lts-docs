---
title: CVE-2024-21490
---

## Vulnerability Details
CVE-2024-21490 is a Regular Expression Denial of Service (ReDoS) vulnerability in AngularJS affecting the `ng-srcset` directive when processing srcset values with many spaces.

## The Vulnerability

### Problem
A regular expression used by the `ng-srcset` directive to process srcset values is vulnerable to **super-linear runtime due to backtracking** when processing srcset values containing many consecutive spaces. This can result in catastrophic backtracking and cause a denial of service.

### Impact
Attackers could:
1. **Cause denial of service** by triggering `ng-srcset` with malicious srcset patterns
2. **Freeze the browser UI** through excessive regex processing
3. **Consume excessive CPU resources** on the client side
4. **Degrade application performance** for affected users

### Technical Details
The vulnerability occurs when `ng-srcset` processes srcset values containing many consecutive spaces. The internal regex used for srcset parsing exhibits catastrophic backtracking behavior with such input.

This is essentially equivalent to:
```javascript
// ng-srcset with many spaces
<img ng-srcset="'http://example.com/image.png 2x, ' + ' '.repeat(largeNumber) + 'http://example.com/image.png'" />
```

## Patch Information

### Commit Details
- **Commit SHA**: [03609306e](https://github.com/TJSTONE99/angular.js-lts/commit/03609306e2cb68dea23d77e615d52c5a76adff51)
- **Author**: TJSTONE99
- **Date**: January 2, 2026
- **Message**: fix: CVE-2024-21490

### Fix Summary
The patch fixes ReDoS vulnerability in srcset parsing by replacing vulnerable regex with linear-time alternatives:

1. **Replaced vulnerable regex**: Rewrote srcset parsing logic to avoid catastrophic backtracking
2. **Linear-time processing**: Implemented efficient parsing that scales linearly with input size
3. **Maintained functionality**: Preserved all existing srcset parsing behavior while eliminating ReDoS risk
4. **Comprehensive testing**: Added extensive test coverage for ReDoS scenarios

### Files Modified
- `src/ng/compile.js`
- `test/ng/compileSpec.js`
- `test/ng/directive/ngSrcsetSpec.js`
- `test/ng/ngPropSpec.js`

### Key Changes
The fix completely rewrites the srcset parsing logic to use linear-time algorithms instead of vulnerable regex patterns. The new implementation processes srcset values character by character, avoiding the backtracking behavior that caused the ReDoS vulnerability while maintaining full compatibility with existing functionality.

## References
- NVD: https://nvd.nist.gov/vuln/detail/CVE-2024-21490
- HeroDevs Vulnerability Directory: https://www.herodevs.com/vulnerability-directory/cve-2024-21490?nes-for-angularjs=
- Debian Security Tracker: https://security-tracker.debian.org/tracker/CVE-2024-21490

### Pre-patch PoC
The `ng-srcset` directive is vulnerable to super-linear runtime due to backtracking when processing srcset values with many consecutive spaces, causing the browser tab to become unresponsive.

:::warning
**⚠️ WARNING:** Using large srcset values will cause the browser tab to become unresponsive.
:::

The demonstration below shows the issue by compiling an `ng-srcset` with a value containing many spaces. You can observe that the time increases super-linearly relative to the number of spaces.

<iframe 
  src="/angular-lts-docs/cve-demos/CVE-2024-21490/unpatched/index.html" 
  width="100%" 
  height="400" 
  style={{border: '1px solid #e1e4e8', borderRadius: '6px'}}
  title="CVE-2024-21490 Vulnerable Demo">
</iframe>

### Post-patch PoC
Malicious srcset patterns no longer cause performance degradation, `ng-srcset` completes in reasonable time regardless of input size, and normal srcset functionality remains intact.

<iframe 
  src="/angular-lts-docs/cve-demos/CVE-2024-21490/patched/index.html" 
  width="100%" 
  height="400" 
  style={{border: '1px solid #e1e4e8', borderRadius: '6px'}}
  title="CVE-2024-21490 Patched Demo">
</iframe>

### Expected Behavior After Fix
- Malicious srcset patterns no longer cause performance degradation
- `ng-srcset` completes in reasonable time regardless of input size
- Normal srcset functionality remains intact

## References
- NVD: https://nvd.nist.gov/vuln/detail/CVE-2024-21490
- HeroDevs Vulnerability Directory: https://www.herodevs.com/vulnerability-directory/cve-2024-21490?nes-for-angularjs=
- Debian Security Tracker: https://security-tracker.debian.org/tracker/CVE-2024-21490
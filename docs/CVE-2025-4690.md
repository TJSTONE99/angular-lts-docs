---
title: CVE-2025-4690
---

## Vulnerability Details
CVE-2025-4690 is a Regular Expression Denial of Service (ReDoS) issue in AngularJS affecting URL detection in the `linky` filter.

## The Vulnerability

### Problem
A regular expression used by `linky` to detect URLs can exhibit **super-linear runtime due to backtracking**, allowing an attacker to cause excessive CPU usage with crafted input.

### Impact
Attackers could:
1. **Hang the UI thread** in browsers (client-side DoS)
2. **Spike CPU usage** while rendering/sanitizing attacker-controlled text
3. **Degrade application availability** for affected users

### Technical Details
The vulnerability occurs when the `linky` filter processes text containing many consecutive alphanumeric characters that are not part of a valid email (i.e., not followed by `@something`). The regular expression used for URL detection exhibits catastrophic backtracking behavior with such input.

This is essentially equivalent to:
```javascript
linkyFilter(userProvidedText);
```

## Testing the Fix

### Pre-patch PoC
The `linky` filter processes text containing many consecutive alphanumeric characters that exhibit catastrophic backtracking behavior, causing the browser tab to become unresponsive with super-linear processing time.

:::warning
**⚠️ WARNING:** Using large input text will cause the browser tab to become unresponsive.
:::

The demonstration below shows the issue by passing user-provided text to the `linky` filter. You can observe that the time taken to complete the "linkification" grows super-linearly with regard to the input size.

<iframe 
  src="/angular-lts-docs/cve-demos/CVE-2025-4690/unpatched/index.html" 
  width="100%" 
  height="400" 
  style={{border: '1px solid #e1e4e8', borderRadius: '6px'}}
  title="CVE-2025-4690 Vulnerable Demo">
</iframe>

### Post-patch PoC
Crafted inputs no longer cause significant stalls and normal URL detection still works with linear-time processing.

<iframe 
  src="/angular-lts-docs/cve-demos/CVE-2025-4690/patched/index.html" 
  width="100%" 
  height="400" 
  style={{border: '1px solid #e1e4e8', borderRadius: '6px'}}
  title="CVE-2025-4690 Patched Demo">
</iframe>

## Patch Information

### Commit Details
- **Commit SHA**: [028eeca2b](https://github.com/TJSTONE99/angular.js-lts/commit/028eeca2b6b2fa78d2b045ae4c0ec176db81bac4)
- **Author**: TJSTONE99
- **Date**: January 3, 2026
- **Message**: fix: CVE-2025-4690

### Fix Summary
The patch completely rewrites the `linky` filter to prevent ReDoS attacks by:

1. **Splitting regex patterns**: Replaced the single vulnerable regex with separate, safer patterns for protocols, www URLs, and emails
2. **Adding ReDoS detection**: Implemented `looksLikeReDoS()` function to detect potentially malicious input patterns
3. **Chunking large inputs**: Added text chunking for processing very large inputs efficiently
4. **Overlap prevention**: Added logic to prevent duplicate matches across different regex patterns
5. **Performance limits**: Added maximum text length and chunk size limits for protection

### Files Modified
- `src/ngSanitize/filter/linky.js`
- `test/ngSanitize/filter/linkySpec.js`

### Key Changes
- Replaced vulnerable `LINKY_URL_REGEXP` with three separate regexes
- Added comprehensive ReDoS protection mechanisms
- Maintained backward compatibility for normal URL detection
- Added extensive test coverage for ReDoS scenarios

## References
- NVD: https://nvd.nist.gov/vuln/detail/CVE-2025-4690
- HeroDevs Vulnerability Directory: https://www.herodevs.com/vulnerability-directory/cve-2025-4690?nes-for-angularjs=
- Debian Security Tracker: https://security-tracker.debian.org/tracker/CVE-2025-4690

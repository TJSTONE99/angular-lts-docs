---
title: CVE-2024-8373
---

## Vulnerability Details
CVE-2024-8373 is a sanitization bypass vulnerability in AngularJS affecting `<source>` element `srcset` attribute handling.

## The Vulnerability

### Problem
Setting a `<source>` element's `srcset` attribute value via the `ngAttrSrcset` directive or interpolation is **not subject to image source sanitization**. This allows bypassing configured image source restrictions.

### Impact
Attackers could:
1. **Bypass image source sanitization rules** configured by the application
2. **Load images from unauthorized domains** or schemes
3. **Perform content spoofing attacks** by displaying malicious images
4. **Degrade application performance** with large or slow-to-load images

### Technical Details
The vulnerability occurs when using:
- `ng-attr-srcset` directive on `<source>` elements
- Interpolation with `srcset` attribute (e.g., `srcset="{{ imageUrl }}"`)

These methods bypass the `imgSrcSanitizationTrustedUrlList` restrictions, while `ng-srcset` and `ng-prop-srcset` directives work correctly with sanitization.

## Patch Information

### Commit Details
- **Commit SHA**: [7ea8e0528](https://github.com/TJSTONE99/angular.js-lts/commit/7ea8e0528022bcd2bf5f33cc6b92dc16e0bbf09d)
- **Author**: TJSTONE99
- **Date**: January 2, 2026
- **Message**: fix: CVE-2024-8373

### Fix Summary
The patch extends srcset sanitization to include `<source>` elements by modifying the attribute sanitization logic:

1. **Extended element coverage**: Modified the srcset sanitization check to include both `img` and `source` elements
2. **Consistent sanitization**: Ensures `<source>` elements are subject to the same URL validation as `<img>` elements
3. **Maintained compatibility**: Preserves existing behavior for all other elements and attributes

### Files Modified
- `src/ng/compile.js`
- `test/ng/compileSpec.js`

### Key Changes
```javascript
// Before (vulnerable)
if (nodeName === 'img' && key === 'srcset') {

// After (fixed)
if ((nodeName === 'img' || nodeName === 'source') && key === 'srcset') {
```

The fix ensures that when `srcset` attributes are set programmatically on `<source>` elements (via `ng-attr-srcset` or interpolation), they are properly sanitized using the same `sanitizeSrcset()` function that was already protecting `<img>` elements.

## References
- NVD: https://nvd.nist.gov/vuln/detail/CVE-2024-8373
- HeroDevs Vulnerability Directory: https://www.herodevs.com/vulnerability-directory/cve-2024-8373?nes-for-angularjs=
- Debian Security Tracker: https://security-tracker.debian.org/tracker/CVE-2024-8373

### Pre-patch PoC
`ng-attr-srcset` and `srcset` interpolation bypass sanitization rules, allowing images from unauthorized domains to be loaded on `<source>` elements.

The demonstration below shows how `ng-attr-srcset` and `srcset` interpolation bypass image source sanitization rules, while `ng-srcset` and `ng-prop-srcset` correctly enforce them.

<iframe 
  src="/angular-lts-docs/cve-demos/CVE-2024-8373/unpatched/index.html" 
  width="100%" 
  height="600" 
  style={{border: '1px solid #e1e4e8', borderRadius: '6px'}}
  title="CVE-2024-8373 Vulnerable Demo">
</iframe>

### Post-patch PoC
All `srcset` methods respect sanitization configuration, and unauthorized image sources are properly blocked.

<iframe 
  src="/angular-lts-docs/cve-demos/CVE-2024-8373/patched/index.html" 
  width="100%" 
  height="600" 
  style={{border: '1px solid #e1e4e8', borderRadius: '6px'}}
  title="CVE-2024-8373 Patched Demo">
</iframe>

### Expected Behavior After Fix
- `ng-attr-srcset` respects `imgSrcSanitizationTrustedUrlList` configuration
- `srcset` interpolation applies proper sanitization
- `ng-srcset` and `ng-prop-srcset` continue to work correctly (not affected)

## References
- NVD: https://nvd.nist.gov/vuln/detail/CVE-2024-8373
- HeroDevs Vulnerability Directory: https://www.herodevs.com/vulnerability-directory/cve-2024-8373?nes-for-angularjs=
- Debian Security Tracker: https://security-tracker.debian.org/tracker/CVE-2024-8373
---
title: CVE-2024-8372
---

## Vulnerability Details
CVE-2024-8372 is an image source sanitization bypass vulnerability in AngularJS affecting `ng-srcset`, `ng-attr-srcset`, and `ng-prop-srcset` directives on `img` elements.

## The Vulnerability

### Problem
The logic used in the `ng-srcset`, `ng-attr-srcset`, and `ng-prop-srcset` directives to sanitize image source URLs has a vulnerability that allows **bypassing restrictions with specially-crafted srcset values**. This affects applications that configure image source sanitization rules.

### Impact
Attackers could:
1. **Bypass image source sanitization rules** configured by the application
2. **Load images from unauthorized domains** or schemes
3. **Perform content spoofing attacks** by displaying malicious images
4. **Degrade application performance** with large or slow-to-load images

### Technical Details
The vulnerability occurs when using specially-crafted `srcset` values that contain multiple image sources. By including a legitimate source first followed by a malicious source, the sanitization logic can be bypassed.

For example: `"https://trusted-domain.com/image.png xyz,https://malicious-domain.com/image.png"`

This affects:
- `ng-srcset` directive on `img` elements
- `ng-attr-srcset` directive on `img` elements  
- `ng-prop-srcset` directive on `img` elements
- Interpolation with `srcset` attribute

Note: `ng-src` directive is not affected and works correctly with sanitization.

## Testing the Fix

### Pre-patch PoC
Specially-crafted `srcset` values bypass sanitization rules by including a legitimate source first followed by a malicious source, allowing images from unauthorized domains to be loaded using the bypass technique.

The demonstration below shows how specially-crafted `srcset` values can bypass image source sanitization rules, while `ng-src` correctly enforces them.

<iframe 
  src="/angular-lts-docs/cve-demos/CVE-2024-8372/unpatched/index.html" 
  width="100%" 
  height="700" 
  style={{border: '1px solid #e1e4e8', borderRadius: '6px'}}
  title="CVE-2024-8372 Vulnerable Demo">
</iframe>

### Post-patch PoC
All `srcset` methods properly validate every image source in the srcset, and unauthorized image sources are blocked regardless of their position in the srcset.

<iframe 
  src="/angular-lts-docs/cve-demos/CVE-2024-8372/patched/index.html" 
  width="100%" 
  height="700" 
  style={{border: '1px solid #e1e4e8', borderRadius: '6px'}}
  title="CVE-2024-8372 Patched Demo">
</iframe>

### Expected Behavior After Fix
- `ng-srcset`, `ng-attr-srcset`, and `ng-prop-srcset` respect `imgSrcSanitizationTrustedUrlList` configuration
- All image sources in a srcset are validated, not just the first one
- `ng-src` continues to work correctly (not affected by this vulnerability)

## Patch Information

### Commit Details
- **Commit SHA**: [43445fa4e](https://github.com/TJSTONE99/angular.js-lts/commit/43445fa4e0e026489aac2e4beebd19924d11d8d4)
- **Author**: TJSTONE99
- **Date**: January 2, 2026
- **Message**: fix: CVE-2024-8372

### Fix Summary
The patch fixes srcset sanitization bypass by implementing proper per-URL validation in srcset attributes:

1. **Enhanced srcset parsing**: Improved `isSeparatorComma()` function to better detect URL boundaries in srcset values
2. **Quote handling**: Added logic to strip wrapping quotes from URL candidates before validation
3. **Per-URL sanitization**: Modified directive handling to ensure each URL in a srcset is individually validated
4. **Comprehensive coverage**: Applied fixes to `ng-srcset`, `ng-attr-srcset`, and `ng-prop-srcset` directives

### Files Modified
- `src/ng/compile.js`
- `src/ng/directive/attrs.js`
- `test/ng/compileSpec.js`
- `test/ng/directive/ngSrcsetSpec.js`
- `test/ng/ngPropSpec.js`

### Key Changes
- **Enhanced comma detection**: Better parsing logic to identify URL boundaries in srcset strings
- **Quote stripping**: Removes wrapping quotes before URL validation to prevent bypass
- **Individual URL validation**: Each URL in a srcset is now validated separately against `imgSrcSanitizationTrustedUrlList`
- **Comprehensive test coverage**: Added extensive tests covering various bypass scenarios

The fix ensures that all URLs in srcset attributes are properly validated, preventing attackers from bypassing sanitization rules by crafting malicious srcset values.

## References
- NVD: https://nvd.nist.gov/vuln/detail/CVE-2024-8372
- HeroDevs Vulnerability Directory: https://www.herodevs.com/vulnerability-directory/cve-2024-8372?nes-for-angularjs=
- Debian Security Tracker: https://security-tracker.debian.org/tracker/CVE-2024-8372